<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>aritmetica.py | Proyecto Euler</title>
<link href="../../assets/css/bitter.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/main.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://profedrini.github.io/euler/pages/aritmeticapy/">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'left', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><meta name="author" content="Drini">
<meta property="og:site_name" content="Proyecto Euler">
<meta property="og:title" content="aritmetica.py">
<meta property="og:url" content="http://profedrini.github.io/euler/pages/aritmeticapy/">
<meta property="og:description" content="aritmética.py¶Versión en GitHub
Muchos problemas del proyecto Euler involucran funciones aritméticas (determinar si un número es primo, encontrar su factorización,  calcular el número de divisores, et">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-09-01T18:31:17Z">
<meta name="author" content="Drini">
<meta property="og:site_name" content="Proyecto Euler">
<meta property="og:title" content="aritmetica.py">
<meta property="og:url" content="http://profedrini.github.io/euler/pages/aritmeticapy/">
<meta property="og:description" content="aritmética.py¶Versión en GitHub
Muchos problemas del proyecto Euler involucran funciones aritméticas (determinar si un número es primo, encontrar su factorización,  calcular el número de divisores, et">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-09-01T18:31:17Z">
</head>
<body>
    <section class="social"><ul>
<li><a href="../../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="../../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://euclides.org.mx" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/profedrini" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/profedrini" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
<article class="storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name">aritmetica.py</h1>

        
    </header><div itemprop="articleBody text">
    <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="aritmética.py">aritmética.py<a class="anchor-link" href=".#aritm%C3%A9tica.py">¶</a>
</h2>
<p><a href="https://github.com/profedrini/euler/blob/master/aritmetica.py">Versión en GitHub</a></p>
<p>Muchos problemas del proyecto Euler involucran funciones aritméticas (determinar si un número es primo, encontrar su factorización,  calcular el número de divisores, etcétera).</p>
<p>Por ello, implemento una librería para funciones aritméticas.</p>
<ul>
<li>Principios: En caso de ser posible, preferir usar ram/memoria a ciclos de cpu.</li>
<li>Corolario: Almacenar valores calculados para evitar calcularlos de nuevo.</li>
</ul>
<p>El objetivo de este documento es discutir algunas de las funciones que se encuentran en dicho archivo.</p>
<p>En lo posible haremos uso de las siguientes librerías estándar</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Como base de todo nuestro proceso, generamos una lista con los números primos hasta cierto valor. Aunque en la versión final de la librería, simplemente cargamos la lista directamente en código, revisamos de todos modos algunas formas de hacerlo.</p>
<p>Por ejemplo, si queremos calcular todos los números primos menores que $10^4$:</p>
<ul>
<li>Generamos una lista  [0,1,2,3, ..., 9999] e iremos cambiando los valores que no sean primos por cero. </li>
<li>Dado que 1 es un caso especial, lo descartamos manualmente.</li>
<li>Posteriormente, para cada $d\le \sqrt{MAXP}$, si L[d]=0, ya hemos determinado que no es primo (y por tanto todos sus múltiplos también). En caso contrario, tenemos un primo y usamos la criba para hacer cero todos sus múltiplos en la lista.<ul>
<li>Esto lo hacemos con itertools.islice, que selecciona los índices 2d, 3d, 4d, ....</li>
</ul>
</li>
<li>Al final, filtramos todos los valores que no se hayan anulado.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [119]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="o">%%</span><span class="k">timeit</span>
MAXP=10**4
L=[n for n in range(MAXP)]  
L[0]=0
L[1]=0
for d in range(2,int(math.sqrt(MAXP))+1):
    if L[d]&gt;0:   # Si ya descartamos d, ya descartamos a sus múltiplos, sólo se necesita verificar si L[d]=True
        for k in it.islice(range(MAXP), 2*d, None, d): L[k]=0
    #if d*d&gt;MAXP: break
Primos=[P for P in L if P&gt;0 ]
#print(Primos)
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>100 loops, best of 3: 6.02 ms per loop
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Usando el mismo código para hallar todos los primos menores que un millón:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [125]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="o">%%</span><span class="k">time</span>
MAXP=10**6
L=[n for n in range(MAXP)]  
L[0]=0
L[1]=0
for d in range(2,int(math.sqrt(MAXP))+1):
    if L[d]&gt;0:   # Si ya descartamos d, ya descartamos a sus múltiplos, sólo se necesita verificar si L[d]=True
        for k in it.islice(range(MAXP), 2*d, None, d): L[k]=0
ListaPrimos=[P for P in L if P&gt;0 ]
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 3.54 s, sys: 3 ms, total: 3.54 s
Wall time: 3.54 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Toma menos de 4 segundos el hallar todos los primos menores que un millón.</p>
<p>Sólo por curiosidad, haremos un intento híbrido: generamos todos los primos menores que $10^3$ y luego los usamos para cribar los números hasta $10^3$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [126]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="o">%%</span><span class="k">time</span>
MAXP=10**6
MEDP=10**3
S=[n for n in range(MEDP)]   # En python3, range es un generador, no existe xrange
S[0]=0
S[1]=0
for d in range(2,int(math.sqrt(MEDP))+1):
    if S[d]&gt;0:   # Si ya descartamos d, también sus múltiplos, sólo hay que verificar si L[d]=True
        for k in it.islice(range(MEDP), 2*d, None, d): S[k]=0
S=[p for p in S if p&gt;0 ]
L=[n for n in range(MEDP, MAXP)]
for p in S:
    L = [m for m in L if m%p&gt;0]
    
ListaPrimos=(S+L)
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 3.55 s, sys: 4 ms, total: 3.55 s
Wall time: 3.55 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Una tercera posibilidad consiste en ir eliminando de la lista los números que no sean primos, en vez de hacer que sus índices sean iguales a cero y recolectar al final:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [184]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="o">%%</span><span class="k">time</span>
MAXP=10**6
L=[2]+[n for n in range(3,MAXP,2)]  
for d in range(3,int(math.sqrt(MAXP))+1,2):
    if d in L:   # Si ya eliminamos d, ya eliminamos a sus múltiplos, sólo se necesita verificar si L[d]=True
        L = [m for m in L if m&lt;=d or m%d&gt;0]
ListaPrimos=L
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 5.54 s, sys: 2 ms, total: 5.54 s
Wall time: 5.53 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>La razón por la cual esto es más tardado, probablemente sea que se están copiando y modificando listas, y el manejo de memoria correspondiente lleve más tiempo que simplemente cambiar los valores y modificar listas sólo una vez al final.</p>
<p>Dado que no hay una mejora sustancial en las dos versiones, optamos por quedarnos con la versión primera, ya que es más simple.</p>
<p>Dado que la verificación de pertenencia es más rápida con un conjunto, creamos paralelamente la versión no ordenada:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [127]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">ConjuntoPrimos</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">ListaPrimos</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [183]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 5.51 s, sys: 3 ms, total: 5.51 s
Wall time: 5.51 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [178]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ListaPrimos</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1229
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [188]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="o">%%</span><span class="k">time</span>
MAXP=10**4
L=[n for n in range(MAXP)]  
L[0]=0
L[1]=0
for d in range(2,int(math.sqrt(MAXP))+1):
    if L[d]&gt;0:   # Si ya descartamos d, ya descartamos a sus múltiplos, sólo se necesita verificar si L[d]=True
        for k in it.islice(range(MAXP), 2*d, None, d): L[k]=0
ListaPrimos=[P for P in L if P&gt;0 ]
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 25 ms, sys: 1 ms, total: 26 ms
Wall time: 25.4 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [189]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ListaPrimos</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1229
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

</div>
</div>
</div>

</div>
    </div>
  </div>

    </div>
</article><footer id="footer"><p>Contents © 2015         <a href="mailto:profedrini">Drini</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="../../assets/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="../../assets/js/jquery.timeago.js" type="text/javascript"></script><script src="../../assets/js/mathjax.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
